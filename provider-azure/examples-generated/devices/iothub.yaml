apiVersion: devices.azure.upbound.io/v1beta1
kind: IOTHub
metadata:
  name: example
spec:
  forProvider:
    cloudToDevice:
    - defaultTtl: PT1H
      feedback:
      - lockDuration: PT30S
        maxDeliveryCount: 15
        timeToLive: PT1H10M
      maxDeliveryCount: 30
    endpoint:
    - batchFrequencyInSeconds: 60
      connectionStringSecretRef:
        key: attribute.primary_blob_connection_string
        name: example-storage-account
        namespace: crossplane-system
      containerNameRef:
        name: example
      encoding: Avro
      fileNameFormat: '{iothub}/{partition}_{YYYY}_{MM}_{DD}_{HH}_{mm}'
      maxChunkSizeInBytes: 10485760
      name: export
      type: AzureIotHub.StorageContainer
    - connectionStringSecretRef:
        key: attribute.primary_connection_string
        name: example-eventhub-authorization-rule
        namespace: crossplane-system
      name: export2
      type: AzureIotHub.EventHub
    enrichment:
    - endpointNames:
      - export
      - export2
      key: tenant
      value: $twin.tags.Tenant
    location: West Europe
    resourceGroupNameRef:
      name: example
    route:
    - condition: "true"
      enabled: true
      endpointNames:
      - export
      name: export
      source: DeviceMessages
    - condition: "true"
      enabled: true
      endpointNames:
      - export2
      name: export2
      source: DeviceMessages
    sku:
    - capacity: "1"
      name: S1
    tags:
      purpose: testing
  providerConfigRef:
    name: example
