apiVersion: insights.azure.upbound.io/v1beta1
kind: MonitorMetricAlert
metadata:
  annotations:
    upjet.upbound.io/manual-intervention: "This resource depends on a ActionGroup and it needs manual intervention."
  name: example
spec:
  forProvider:
    action:
    - actionGroupIdRef:
        name: example
    criteria:
    - aggregation: Total
      dimension:
      - name: ApiName
        operator: Include
        values:
        - '*'
      metricName: Transactions
      metricNamespace: Microsoft.Storage/storageAccounts
      operator: GreaterThan
      threshold: 50
    description: Action will be triggered when Transactions count is greater than
      50.
    resourceGroupNameRef:
      name: example-insights-rg
    scopesRefs:
    - name: example-storage-account-insights
---
apiVersion: azure.upbound.io/v1beta1
kind: ResourceGroup
metadata:
  name: example-insights-rg
spec:
  forProvider:
    location: West Europe
    tags:
      provisioner: crossplane
---
apiVersion: insights.azure.upbound.io/v1beta1
kind: MonitorActionGroup
metadata:
  name: example
spec:
  forProvider:
    armRoleReceiver:
    - name: armroleaction
      roleId: de139f84-1756-47ae-9be6-808fbbe84772
      useCommonAlertSchema: true
    azureAppPushReceiver:
    - emailAddress: admin@contoso.com
      name: pushtoadmin
    emailReceiver:
    - emailAddress: admin@contoso.com
      name: sendtoadmin
    - emailAddress: devops@contoso.com
      name: sendtodevops
      useCommonAlertSchema: true
    resourceGroupNameRef:
      name: example-insights-rg
    shortName: p0action
    smsReceiver:
    - countryCode: "1"
      name: oncallmsg
      phoneNumber: "1231231234"
    webhookReceiver:
    - name: callmyapiaswell
      serviceUri: http://example.com/alert
      useCommonAlertSchema: true
---
apiVersion: storage.azure.upbound.io/v1beta1
kind: Account
metadata:
  name: example-storage-account-insights
  annotations:
    crossplane.io/external-name: upaccinsights123
spec:
  forProvider:
    resourceGroupNameRef:
      name: example-insights-rg
    location: West Europe
    accountTier: "Standard"
    accountReplicationType: "LRS"
    tags:
      provisioner: crossplane
  writeConnectionSecretToRef:
    name: example-storage-account
    namespace: upbound-system
